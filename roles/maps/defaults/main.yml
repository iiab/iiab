# NOTE: I'm more than happy to change the variable or directory names to
# something more in line with IIAB expectations.

maps_dot_black_small_assets_url: https://v1.maps.black
unpkg_url: https://unpkg.com
iiab_map_host_url: https://iiab.switnet.org/maps/1

# TODO I wonder if it should go under /library/maps/vector_tiles and symlink from the www directory.
# That way it would be near the search data. It would be easier to find everything.
maps_serve_path: "{{ content_base }}/www/osm/maps"   # /library/www/osm/maps
maps_data_root: "{{ content_base }}/maps"            # /library/maps

nominatim_user: nominatim
nominatim_home: /srv/nominatim
nominatim_num_workers_procs: 1 # 4 seems to freeze it up if I make too many requests. But, maybe 1 is too few. Also, optimal on Pi Zero may be lower.
nominatim_venv: "{{ nominatim_home }}/nominatim-venv"

maps_static_search_dir: "static-search"
maps_static_search_root: "{{ maps_serve_path }}/{{ maps_static_search_dir }}"

# `maps_data_date` is for data that changes all the time (osm vector data,
#     search [eventually!])
# `maps_slow_data_date` is for big data that changes rarely if ever (satellite,
#     natural earth, terrain, search [for now!])
#
# It sucks to have up-to-date files with different dates, but the alternative
# is to force the user to download the same satellite file over and over every
# time the vector data changes. This is why we have the "slow" designation.
# Some of it may never change. Some of it, like search, will probably start
# changing much faster once we're ready for it. We can even decide on multiple
# date designations down the line. I just want one "slow" date to set all of
# these items *for now*.
#
maps_data_date: "2025-12-10"
maps_slow_data_date: "2025-12-10"

tile_extract:
  pmtiles:
    arm64:
      src_url: https://github.com/protomaps/go-pmtiles/releases/download/v1.29.1/go-pmtiles_1.29.1_Linux_arm64.tar.gz
      sha256sum: e44823cff328c2ea354096ccbfd7e7ef6c8f05b11553ad28fcaa33989123a57f
    amd64:
      src_url: https://github.com/protomaps/go-pmtiles/releases/download/v1.29.1/go-pmtiles_1.29.1_Linux_x86_64.tar.gz
      sha256sum: 870c3aa968a75430ca1772351c3a6a6d30103b466d6df5837351bfb340640f54
  pmtiles_archive_tmp_dir: "/opt/iiab/downloads/maps/pmtiles"
  pmtiles_archive_tmp_file: "/opt/iiab/downloads/maps/pmtiles/pmtiles.tar.gz"
  working_dir: "/opt/iiab/maps/tile-extract"
  info_file: "extracts.json"

# Basic maps.black javascript and styles
maps_dot_black_js_and_styles:

#    NOTE: We are now building `maps.black.js` ourselves because we want to
#    make changes to it. See the `build-maps.black-assets/` directory.
#
#    This sha256sum represents the original version before any changes we've
#    made. The other two files are from the same "version" of maps.black; if we
#    update one, we should update the rest.
#
#  - name: maps.black.js
#  -    filename: maps.black.js
#  -    sha256sum: 7b3843b5ded151d585ccf3a6db02093e3a95851be36dcffc5fa92030657b9c93

  - filename: maps.black-component.js
    sha256sum: d8a6366065d5fd6840368e88a5b06467b2c5ac3e349a35420b4dee6cc070e542

  - filename: resourcetiles-minimal.pmtiles
    sha256sum: 0037047ee0f87dbccd3fc7e6bfa99632d97c41cfd5977bff3b7f86665f3c4f51

# MapLibre and plugins, javascript and css
# TODO get the minified versions of all these?
maplibre_js_and_styles:

  - filename: maplibre-gl.css
    url_subpath: maplibre-gl@5.7.3/dist/maplibre-gl.css
    sha256sum: 43c1d886b5fdf0aac4e7135bd6f84b823d9f48283a648012665f9be52c01389f

  - filename: maplibre-gl.js
    url_subpath: maplibre-gl@5.7.3/dist/maplibre-gl.js
    sha256sum: 2986bbddce2c7a944775791201fad5108ec8768fc2e3243cac607b23826e4bc0

  - filename: maplibre-gl-geocoder.min.js
    url_subpath: "@maplibre/maplibre-gl-geocoder@1.5.0/dist/maplibre-gl-geocoder.min.js"
    sha256sum: 21aa5e1cadf31a4b40aeb3f6989f38b486172d6f6266f158431bbf3eefd256f5

  - filename: maplibre-gl-geocoder.css
    url_subpath: "@maplibre/maplibre-gl-geocoder@1.5.0/dist/maplibre-gl-geocoder.css"
    sha256sum: 9fc78e63cbec12058daefb460f630d203a23f209cac8e19a84d0b257e8325fc3

  - filename: maplibre-gl-terradraw.umd.js
    url_subpath: "@watergis/maplibre-gl-terradraw@1.0.1/dist/maplibre-gl-terradraw.umd.js"
    sha256sum: 9085664c7fe755ea861b570e7e5b825a6e8e5294608b1fdfd9c9c4719c2d45d1

  - filename: maplibre-gl-terradraw.css
    url_subpath: "@watergis/maplibre-gl-terradraw@1.0.1/dist/maplibre-gl-terradraw.css"
    sha256sum: 70222f0f0e46344d8f6d0056a1c75a4b247a6985c598fc3ba8880818c08721bc

maps_dot_black_naturalearth6_symlink_name: "naturalearth6-NE2_HR_SR_W_DR-WEBP.pmtiles"

# Mostly colors, topography, etc.
maps_dot_black_naturalearth6_tiles: "naturalearth6-NE2_HR_SR_W_DR-WEBP.{{ maps_slow_data_date }}.full.pmtiles"

# Two different symlinks because the front end could requset openstreetmap or naturalearth
maps_dot_black_osm_symlink_name: openstreetmap-openmaptiles.pmtiles
maps_dot_black_ne_symlink_name: naturalearth-openmaptiles.pmtiles

# File size circa Sept 2025
# TODO - hopefully before this is merged, we'll get rid of "ne" (naturalearth)
# option and just have low zoom osm. So then it will be `maps_vector_zoom` and
# just have numbers, like for satellite.
maps_dot_black_vector_tiles:
  # "high res" full osm, including 3d buildings.
  # (TODO does this include colors and topography? Or is it used along with naturalearth6 above in most styles?)
  # maps_vector_quality = "osm-full"
  osm-full: "openstreetmap-openmaptiles.{{ maps_data_date }}.full.pmtiles"

  # "medium res" osm, up to zoom level 9 (original file has 14).
  # (TODO does this include colors and topography? Or is it used along with naturalearth6 above in most styles?)
  # maps_vector_quality = "osm-z9"
  osm-z9: "openstreetmap-openmaptiles.{{ maps_data_date }}.zoom_0-09.pmtiles"

  # "low res" - mostly borders, rivers, country names, large roads.
  # maps_vector_quality = "ne"
  # (ne = "Natural Earth")
  ne: "naturalearth-openmaptiles.{{ maps_slow_data_date }}.full.pmtiles"

maps_dot_black_satellite_symlink_name: s2maps-sentinel2-2023.pmtiles

maps_dot_black_satellite_tiles:
  # Low quality satellite, up to zoom level 7 (original file has 13)
  # maps_satellite_zoom = 7
  7: "s2maps-sentinel2-2023.{{ maps_slow_data_date }}.zoom_0-07.pmtiles"

  # Moderately high quality satellite, up to zoom level 9 (original file has 13)
  # maps_satellite_zoom = 9
  9: "s2maps-sentinel2-2023.{{ maps_slow_data_date }}.zoom_0-09.pmtiles"

  # Pretty high quality satellite, up to zoom level 11 (original file has 13)
  # maps_satellite_zoom = 11
  11: "s2maps-sentinel2-2023.{{ maps_slow_data_date }}.zoom_0-11.pmtiles"

  # Pretty high quality satellite, up to zoom level 12 (original file has 13)
  # maps_satellite_zoom = 12
  12: "s2maps-sentinel2-2023.{{ maps_slow_data_date }}.zoom_0-12.pmtiles"

  # Highest available quality satellite, up to zoom level 13
  # maps_satellite_zoom = full
  full: "s2maps-sentinel2-2023.{{ maps_slow_data_date }}.full.pmtiles"

# NOTE: This symlink's name matches what maps.black is explicitly querying for.
# However the fact that it includes "z0-z10" is not ideal, as it may point to an
# extract that we made ourselves that only goes to a lower zoom level. In the
# near future, we may be able to change what maps.black queries for, and we
# should change this.
maps_dot_black_terrain_symlink_name: terrarium-z0-z10.pmtiles

maps_dot_black_terrain_tiles:
  # Low quality terrain, up to zoom level 7 (original file has 10)
  # maps_terrain_zoom = 7
  7: "terrarium.{{ maps_slow_data_date }}.zoom_0-07.pmtiles"

  # maps_terrain_zoom = 8
  8: "terrarium.{{ maps_slow_data_date }}.zoom_0-08.pmtiles"

  # maps_terrain_zoom = 9
  9: "terrarium.{{ maps_slow_data_date }}.zoom_0-09.pmtiles"

  # maps_terrain_zoom = 10
  # (This is the highest quality that maps.black offers in pmtiles format. They
  # offer 11, 12, and 13 in squashfs format, but they are massive files.)
  10: "terrarium.{{ maps_slow_data_date }}.full.pmtiles"

  # NOT RECOMMENDED. VERY LOW QUALITY terrain, up to zoom level 5 or 6.
  # We will probably end up getting rid of these, but we would like to test
  # them out to be sure.
  5: "terrarium.{{ maps_slow_data_date }}.zoom_0-05.pmtiles"
  6: "terrarium.{{ maps_slow_data_date }}.zoom_0-06.pmtiles"

# Similar to pmtiles, search databases should follow this convention:
#
#   {search-engine}.{maps_data_date}.full
#   {search-engine}.{maps_data_date}.{subset}
#   {search-engine}.{maps_data_date}.full-region.region-name
#
# Though:
#
# * backend databases such as nominatim will be in /library/maps while static will be under the serve directory
# * "full" might not ever happen, it's a moving target. we could append "-region" regardless
# * {subset} would be something like "pop-1k-cities"

nominatim_db_symlink_name: nominatim.sqlite

nominatim_data:
  # Basic nominatim database
  # maps_search_nominatim_db = "basic"
  basic: "nominatim.{{ maps_slow_data_date }}.basic.sqlite"
    # California admin+natural for now. TODO make a small worldwide one. (unless we go to the frontend-only one)
    # TODO - Make a basic small whole-world map, at least as good as previous maps

  # Full nominatim database
  # maps_search_nominatim_db = "full"
  full: "nominatim.{{ maps_slow_data_date }}.full.sqlite"

static_search_symlink_name: world-map

static_search_data:
  # Cities-only static database
  # maps_search_static_db = "pop-1k-cities"
  pop-1k-cities: "static-search.{{ maps_data_date }}.pop-1k-cities"
