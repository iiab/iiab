- name: Make code directories available
  ansible.builtin.file:
    path: "{{ item }}"
    state: directory
    mode: 0755
  loop:
    - "{{ code_data_root }}"
    - "{{ code_serve_path }}"

- name: Copy static assets
  ansible.builtin.copy:
    src: static/
    dest: "{{ code_data_root_static }}"

- name: Make index.html file
  ansible.builtin.template:
    src: "index.html.j2"
    dest: "{{ code_serve_path }}/index.html"
    mode: "0644"

- name: Make content directory
  file:
    path: "{{ code_data_root_content }}"
    state: directory
    mode: 0755

- name: Render localized Markdown content files
  ansible.builtin.template:
    src: "content/{{ item }}.md.j2"
    dest: "{{ code_data_root_content }}/{{ item }}.md"
    mode: "0644"
  loop:
    - en
    - es

- include_tasks: install_apkfile.yml
