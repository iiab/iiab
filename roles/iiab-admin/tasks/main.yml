- include_tasks: admin-user.yml
  when: iiab_admin_user_install | bool

- include_tasks: access.yml


# RECORD iiab-admin AS INSTALLED

- name: "Set 'iiab_admin_installed: True'"
  set_fact:
    iiab_admin_installed: True

- name: "Add 'iiab_admin_installed: True' to {{ iiab_state_file }}"
  lineinfile:
    path: "{{ iiab_state_file }}"    # /etc/iiab/iiab_state.yml
    regexp: '^iiab_admin_installed'
    line: 'iiab_admin_installed: True'


- name: Add 'iiab-admin' variable values to {{ iiab_ini_file }}
  ini_file:
    dest: "{{ iiab_ini_file }}"    # /etc/iiab/iiab.ini
    section: iiab-admin
    option: "{{ item.option }}"
    value: "{{ item.value | string }}"
  with_items:
    - option: name
      value: iiab-admin
    - option: description
      value: '"Admin User"'
    - option: iiab_admin_user
      value: "{{ iiab_admin_user }}"
