# Base Server

- name: ...IS BEGINNING =====================================
  command: echo

- name: HTTPD
  include_role:
    name: httpd
  # has no "when: XXXXX_install" flag
  tags: base, httpd

- name: IIAB-ADMIN
  include_role:
    name: iiab-admin
  # has no "when: XXXXX_install" flag
  tags: base, iiab-admin

- name: MYSQL
  include_role:
    name: mysql
  # has no "when: XXXXX_install" flag
  tags: base, mysql

- name: Make sure there is a content directory
  file: dest={{ doc_root }}/local_content
        state=directory

- name: Restart httpd
  service: name={{ apache_service }}
           state=restarted
  when: not installing

# this script can be sourced to get IIAB location
- name: Create iiab.env file
  template: src=roles/1-prep/templates/iiab.env.j2
            dest=/etc/iiab/iiab.env
            owner=root
            group=root
            mode=0644

# If we got here we're done
#- name: Record base gui version
#  lineinfile: dest=/etc/iiab/iiab.env
#              regexp='^BASE_VERSION=*'
#              line='BASE_VERSION="{{ gui_version }}"'
#              state=present

- name: ...HAS COMPLETED ====================================
  command: echo
