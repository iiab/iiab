[Unit]
Description=Provides the Lokole Server
#Requires=lokole.socket
After=network.target

[Service]
Type=simple
EnvironmentFile={{ lokole_run_directory }}/settings.env
ExecStart='{{ lokole_venv }}/bin/gunicorn' --timeout='300' --workers='{{ [4, ansible_memtotal_mb / 200] | min | int }}' --bind='unix:{{ lokole_domain_socket }}' --log-level='error' 'opwen_email_client.webapp:app'
ExecReload=/bin/kill -s HUP $MAINPID
ExecStop=/bin/kill -s TERM $MAINPID
User=root
Group=root
PrivateTmp=true

[Install]
WantedBy=multi-user.target
