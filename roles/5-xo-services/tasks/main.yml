# XO Services

- name: ...IS BEGINNING =====================================
  command: echo

- name: ACTIVITY-SERVER
  include_role:
    name: activity-server
  when: activity_server_install | bool
  tags: olpc, activity-server

- name: EJABBERD_XS
  include_role:
    name: ejabberd_xs
  when: ejabberd_xs_install | bool
  tags: olpc, ejabberd-xs

- name: IDMGR
  include_role:
    name: idmgr
  when: idmgr_install | bool
  tags: olpc, idmgr

- name: Install Bluetooth - only on Raspberry Pi
  include_role:
    name: bluetooth
  when: (is_rpi and bluetooth_install) or bluetooth_installed is defined
  tags: bluetooth

- name: CUPS
  include_role:
    name: cups
  when: cups_install or cups_installed is defined
  tags: cups

- name: SAMBA
  include_role:
    name: samba
  when: samba_install or samba_installed is defined
  tags: samba

- name: Recording STAGE 5 HAS COMPLETED =====================
  lineinfile:
    dest: "{{ iiab_env_file }}"
    regexp: '^STAGE=*'
    line: 'STAGE=5'
    state: present
