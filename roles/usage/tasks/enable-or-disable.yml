- name: Enable/Disable/Reload Collection of WiFi client data
  lineinfile: 
      regexp: ".*iiab-wifidata.py$"
      line:  "*/2 * * * * root /usr/bin/iiab-wifidata.py"
      state: present
      path: /etc/crontab
  when: usage_enabled | bool


- name: Enable/Disable/Reload Collection of WiFi client data
  lineinfile: 
      regexp: ".*iiab-wifidata.py$"
      state: absent
      path: /etc/crontab
  when: not usage_enabled

- name: Reset the byte counters once a day so they do not overflow
  # this disconnects all clients and should happen when no clients are working
  lineinfile: 
      regexp: ".*restart hostapd$"
      line:  "*  23  * * * root systemctl restart hostapd"
      state: present
      path: /etc/crontab
  when: usage_enabled | bool

- name: Enable/Disable/Reload Collection of WiFi client data
  lineinfile: 
      regexp: ".*restart hostapd$"
      state: absent
      path: /etc/crontab
  when: not usage_enabled

