# roles/calibre/tasks/main.yml requires calibre_via_debs (to be True) before calling this script.

# MOVED UP TO roles/calibre/tasks/main.yml
#- name: Start by installing OS's Calibre package
#  package:
#    name: "{{ item }}"
#    state: latest
#  with_items:
#    - calibre
#    - calibre-bin
#  when: internet_available

# April/May 2018: Raspbian .deb's for the latest Calibre now appear
# (http://raspbian.raspberrypi.org/raspbian/pool/main/c/calibre/)
# within about 10 days of Calibre's quasi-monthly releases
# (https://calibre-ebook.com/whats-new).

# If you want the latest Calibre, run the appropriate below script, standalone.
# HOWEVER: it's strongly suggested you wait for apt (blessed by your OS!)

- name: Upgrade to Calibre testing .deb's - target Raspbian (rpi)
  command: scripts/calibre-install-latest-rpi.sh
  when: is_rpi and internet_available

- name: Upgrade to Calibre testing .deb's - target Ubuntu 16.04 (not rpi and not ubuntu_18)
  command: scripts/calibre-install-latest.sh
  when: not is_rpi and not is_ubuntu_18 and internet_available

- name: Upgrade to Calibre unstable .deb's IF calibre_unstable_debs
  command: scripts/calibre-install-unstable.sh
  when: calibre_unstable_debs and internet_available
