# generated by IIAB

# iiab_network_mode is {{ iiab_network_role }}
# gui_desired_network_role is {{ gui_desired_network_role }}

#################   WIRELESS LAN   #########################
{% if iiab_wireless_lan_iface != 'none' %}
# we always want the wireless to be configured (and under bridge) if it exists
auto {{ iiab_wireless_lan_iface }}
iface {{ iiab_wireless_lan_iface }} inet manual
   pre-up   ifconfig $IFACE up
   pre-down ifconfig $IFACE down
{% endif %}

#################   BRIDGE & SLAVES   #########################
# hostapd will insert the wireless into the bridge at a later point
auto br0
iface br0 inet static
    bridge_ports {% if iiab_wireless_lan_iface != "none" %} {{ iiab_wireless_lan_iface }} {% if detected_lan != "none" %} {{ detected_lan }} {% endif %}
    bridge_maxwait 0
    address {{ lan_ip }}
    netmask {{ lan_netmask }}
    dns-nameservers {{ lan_ip }}
    dns-search {{ iiab_domain }}
    post-up systemctl restart dhcpd && systemctl restart hostapd

